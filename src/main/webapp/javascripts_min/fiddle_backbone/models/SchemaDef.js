define(["Backbone"],function(e){var t=e.Model.extend({defaults:{ddl:"",short_code:"",simple_name:"",full_name:"",valid:!0,errorMessage:"",loading:!1,ready:!1,schema_structure:[],statement_separator:";",browserEngines:{}},reset:function(){this.set(this.defaults),this.trigger("reloaded")},build:function(e){var t=e.getSelectedType(),n=this;if(!t)return!1;(!this.has("dbType")||this.get("dbType").id!=t.id)&&this.set("dbType",t),$.ajax({type:"POST",url:"index.cfm/fiddles/createSchema",data:{statement_separator:this.get("statement_separator"),db_type_id:this.get("dbType").id,schema_ddl:this.get("ddl")},dataType:"json",success:function(e,r,i){e.short_code?t.get("context")=="browser"?n.get("browserEngines")[t.get("className")].buildSchema({short_code:$.trim(e.short_code),statement_separator:n.get("statement_separator"),ddl:n.get("ddl"),success:function(){n.set({short_code:$.trim(e.short_code),ready:!0,valid:!0,errorMessage:""}),n.get("browserEngines")[t.get("className")].getSchemaStructure({callback:function(e){n.set({schema_structure:e}),n.trigger("built")}})},error:function(t){n.set({short_code:$.trim(e.short_code),ready:!1,valid:!1,errorMessage:t,schema_structure:[]}),n.trigger("failed")}}):(n.set({short_code:$.trim(e.short_code),ready:!0,valid:!0,errorMessage:"",schema_structure:e.schema_structure}),n.trigger("built")):(n.set({short_code:"",ready:!1,valid:!1,errorMessage:e.error,schema_structure:[]}),n.trigger("failed"))},error:function(e,t,r){n.set({short_code:"",ready:!1,valid:!1,errorMessage:r,schema_structure:[]}),n.trigger("failed")}})}});return t})